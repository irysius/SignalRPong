@{
    ViewBag.Title = "Pong";
}

<h2>Pong</h2>
<input type="hidden" id="displayName" />
<input type="hidden" id="playerId" />
<input type="hidden" id="roomId" />
<input type="button" id="btn-join" value="Join Room" disabled/>
<input type="button" id="btn-leave" value="Leave Room" disabled/>
<input type="button" id="btn-start" value="Start Game" disabled/>

@section scripts {
    @Scripts.Render("~/bundles/createjs")
    <script src="~/Scripts/jquery.signalR-1.1.3.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <script>
        $(function () {
            var pong = $.connection.PongHub;
            
            // Hook up all the server to client methods here.
            pong.client.updateMessage = function (message) {
            };
            pong.client.updatePositions = function (p1, p2, bx, by) {
            };
            pong.client.updateScore = function (s1, s2) {
            };
            pong.client.onRoomRegistered = function (roomId, playerId) {
                $('#roomId').val(roomId);
                $('#playerId').val(playerId);
                $('#btn-join').prop('disabled', 'disabled');
                $('#btn-leave').prop('disabled', '');
            };
            pong.client.onGameStartable = function () {
                $('#btn-start').prop('disabled', '');
            };
            pong.client.onGameUnstartable = function () {
                $('#btn-start').prop('disabled', 'disabled');
            };

            $.connection.hub.start().done(function () {
                $('#btn-join').prop('disabled', '');
                // Hook up all client to server actions here.
                
                $('#btn-join').on("click", function () {
                    pong.server.joinGame($('input#displayName').val());
                });
                $('#btn-leave').on("click", function () {
                    pong.server.leaveGame();
                    $('#btn-join').prop('disabled', '');
                    $('#btn-leave').prop('disabled', 'disabled');
                });
                $('#btn-start').on("click", function () {
                    pong.server.startGame();
                });
            });
        });
    </script>
}